\chapter{Quantum Ensambles} \TODO{PUT HAT ON EVERY OPERATOR}

In this chapter, we extend the concepts of statistical mechanics to quantum systems. We will explore the different quantum ensembles and their applications to various physical systems.

We will consider only systems in thermal equilibrium, where the principles of quantum mechanics and statistical mechanics intersect; we will discuss the microcanonical, canonical, and grand canonical ensembles in the quantum context. Additionally, we will examine quantum gases, including Bose-Einstein and Fermi-Dirac statistics.

The systems we are going to address are caracterized by discrete energy levels, and the state of the system \(\ket{\psi} in \mathcal{H}_N\) is described by a density matrix rather than a classical probability distribution
\[
    \rho_{\psi} = \ket{\psi}\bra{\psi} \text{ or } \rho_{\psi} = \sum_{\alpha} p_{\alpha} \ket{\alpha}\bra{\alpha},
\]
Operators are going to be assumed time independent and they will act on the proper Hilbert space of the system: if we are treating a system of $N$ particles, the Hilbert space will be the tensor product of the single-particle Hilbert spaces:
\[
    \begin{aligned}
        \mathcal{H}_{N} & = \mathcal{H}_{1}^{\otimes N} \text{ for distinguishable particles,} \\
        \mathcal{H}_{N} & = \mathcal{H}^{(N)}_{S}  \text{ for bosons,}                         \\
        \mathcal{H}_{N} & = \mathcal{H}^{(N)}_{A} \text{ for fermions,}
    \end{aligned}
\]
and when we will need \(N\) to vary, we will work in the Fock space \(\mathcal{F} = \bigoplus_{N=0}^{\infty} \mathcal{H}^{(N)}_{S/A}\).

The Hamiltonian operator \(\hat{H}_N\) will have discrete eigenvalues \(E_n\) with eigenstates \(\ket{n}\), and it will commute with other observables of the system, such as the number operator \(\hat{N}\)\footnote{Even in the GC ensamble the Hamiltonian will commute with the number operator, if we are using the Hamiltonian defined for a fixed number of particles \(\hat{H}_N\); when we will use the Hamiltonian acting on the Fock space for a variable number of particles \(\hat{H}\) things will be more complicated.}, to ensure conservation laws.

To clarify the procedure, we will replace
\begin{itemize}
    \item the phase space with the appropriate Hilbert space,
    \item the Hamiltonian function with the Hamiltonian operator, self-adjoint and assumed time independent,
    \item the classical probability distribution with the density operator \(\hat{\rho}\) to describe the statistical state of the system,
    \item the partition function with the appropriate quantum renormalization factor, ensuring the trace of the density operator is equal to one,
    \item the classical expectation values with the quantum expectation values, computed as the trace of the product of the density operator and the observable operator.
\end{itemize}

\section{Microcanonical Ensemble}

As in the classical case, the microcanonical ensemble describes an isolated quantum system with fixed energy \(E\) (configurations on a costant energy surface), volume \(V\), and number of particles \(N\); most operators will have a descrete spectrum and a finite degeneracy \(g_n\) associated to each energy level \(E_n\), working at fixed volume and number of particles.

Given an ON basis \(\{\ket{\psi_{j,\,\alpha}}\}_{j,\,\alpha}\), the generiv time independent Hamiltonian operator \(\hat{H}\) can be diagonalized as
\[
    \hat{H} \ket{\psi_{j,\,\alpha}} = E_j \ket{\psi_{j,\,\alpha}}, \quad \alpha = 1, \ldots, g_j,
\]
where \(\alpha\) encodes the degeneracy \(g_j\) of each energy level \(E_j\) and we can express the Hamiltonian in terms of its spectral decomposition:
\[
    \hat{H} = \sum_{j} \sum_{\alpha=1}^{g_j} E_j \ket{\psi_{j,\,\alpha}}\bra{\psi_{j,\,\alpha}} = \sum_{j} E_j \mathbb{P}_j,
\]
where \(\mathbb{P}_j = \sum_{\alpha=1}^{g_j} \ket{\psi_{j,\,\alpha}}\bra{\psi_{j,\,\alpha}}\) is the projector onto the eigenspace associated to the energy level \(E_j\). Since the system is isolated, the energy is constrained to lie within a small interval \([E, E + \delta E]\), and all accessible microstates within this energy range are equally probable: in the microcanonical ensamble we have \(E=E_{j_0}\), so that
\begin{itemize}
    \item \(\ket{\psi_{j,\,\alpha}}\) has zero probability for all \(j \neq j_0\),
    \item \(\ket{\psi_{j_0,\,\alpha}}\) has equal probability \(\frac{1}{g_{j_0}}\) for all \(\alpha = 1, \ldots, g_{j_0}\).
\end{itemize}

Thus the density operator for a mixed state of the microcanonical ensemble is given by
\[
    \rho_{mc} = \sum_{j \neq j_0,\,\alpha} (p_{j \neq j_0,\,\alpha} = 0) \ket{\psi_{j,\,\alpha}}\bra{\psi_{j,\,\alpha}} + \sum_{\alpha=1}^{g_{j_0}} p_{j_0} \ket{\psi_{j_0,\,\alpha}}\bra{\psi_{j_0,\,\alpha}},
\]
with \(p_{j_0} = \frac{1}{g_{j_0}}\) since we have equal probabilities for all microstates at energy \(E_{j_0}\) and they must sum to one; therefore we can rewrite the density operator as
\begin{equation}
    \rho_{mc} = \frac{1}{g_{j_0}} \mathbb{P}_{j_0} = \frac{1}{g_{j_0}} \sum_{\alpha=1}^{g_{j_0}} \ket{\psi_{j_0,\,\alpha}}\bra{\psi_{j_0,\,\alpha}},
    \label{eq:microcanonical_density_operator}
\end{equation}
Since the density operator is normalized, we have \(\text{Tr}(\rho_{mc}) = 1\). Let us drop the subscript \(j_0\) when there is no ambiguity, since we are working at fixed energy, after selecting a specific eigenspace of the Hamiltonian. We can look at the matrix elements of the density operator in the energy eigenbasis:
\[
    \rho_{mc} = \begin{pmatrix}
        0      & 0           & 0      & \cdots      & 0      \\
        0      & \frac{1}{g} & 0      & \cdots      & 0      \\
        0      & 0           & \ddots & \cdots      & 0      \\
        \vdots & \vdots      & \vdots & \frac{1}{g} & \vdots \\
        0      & 0           & 0      & \cdots      & 0
    \end{pmatrix},
\]
it is a block diagonal matrix with a block of size \(g \times g\) with all entries equal to \(\frac{1}{g}\) corresponding to the degenerate energy level \(E\), and zeros elsewhere.

The expectation value of an observable \(A\) in the microcanonical ensemble is given by
\begin{equation}
    \langle A \rangle_{mc}  = \text{Tr}(\rho_{mc} A) = \frac{1}{g} \sum_{\alpha=1}^{g} \bra{\alpha} A \ket{\alpha},
    \label{eq:quantum_microcanonical_expectation_value}
\end{equation}
where \(\frac{1}{g}\) represents the equal probability of each microstate within the energy shell; we also used \(\ket{\alpha}\) to denote the eigenstates \(\ket{\psi_{j,\,\alpha}}\) for simplicity.

We can also define the quantum analog of the entropy in the microcanonical ensemble, from the Boltzmann formula:
\[
    \begin{aligned}
        S & = - k_B \langle \log \rho_{mc} \rangle_{mc} = -k_B \text{Tr}(\rho_{mc} \log \rho_{mc})                                                                                  \\
          & = - k_B \sum_{\alpha} \bra{\alpha} \left[ \frac{1}{g} \sum_{\beta} \ket{\beta}\bra{\beta} \log(\frac{1}{g} \sum_{\gamma} \ket{\gamma}\bra{\gamma}) \right] \ket{\alpha} \\
          & = -k_B \sum_{\alpha} \frac{1}{g} \log(\frac{1}{g}) \bra{\alpha} \ket{\alpha} = - k_B \frac{g}{g} \log(\frac{1}{g}) = k_B \log g,
    \end{aligned}
\]
where again \(g\) is the number of accessible microstates at energy \(E\) and we have used the completeness relations \(\sum_{\alpha} \ket{\alpha}\bra{\alpha} = \mathbb{I}\).
Everything else being equal, a higher degeneracy \(g\) leads to a higher entropy \(S\), reflecting the greater number of accessible microstates for the system. This aligns with the classical interpretation of entropy as a measure of the number of microstates corresponding to a given macrostate.

\section{Canonical Ensemble}

In the canonical ensemble, we consider a quantum system in thermal equilibrium with a heat bath at a fixed temperature \(T\). The system can exchange energy with the bath, leading to fluctuations in its energy levels. The number of particles \(N\) and the volume \(V\) of the system remain constant.

Now we cannot restrict the system to a single energy level, as in the microcanonical ensemble; instead, the system can occupy various energy levels \(E_j\) with probabilities determined by the Boltzmann factors: for each level \(E_j\) the system has a probability proportional to \(e^{-\beta E_j}\) of being observed in that level.

Now the density operator for the canonical ensemble is given by
\begin{equation}
    \rho_{c} = \frac{1}{Z_N} \sum_{j} e^{-\beta E_j} \mathbb{P}_j = \frac{1}{Z_N} e^{-\beta H_N},
    \label{eq:canonical_density_operator}
\end{equation}
where \(Z_N= \text{Tr}(e^{-\beta H_N})\) is the partition function, ensuring the normalization of the density operator. Let's compute this results explicitly:
\[
    e^{-\beta H_N} = \sum_{n} \frac{(-\beta H_N)^n}{n!} = \sum_{n} \frac{(-\beta)^n}{n!} \left( \sum_{j} E_j \mathbb{P}_j \right)^n,
\]
practically we need to compute the \(n\)-th power of the Hamiltonian:
\[
    H_N^2 = \left(\sum_{i} E_i \mathbb{P}_i \right)\left(\sum_{j} E_j \mathbb{P}_j \right) = \sum_{i,\,j} E_i E_j \mathbb{P}_i \mathbb{P}_j = \sum_{j} E_j^2 \mathbb{P}_j,
\]
so we can generalize to \(H_N^{n} = \sum_{j} E_j^{n} \mathbb{P}_j\); thus we have
\[
    e^{-\beta H_N} = \sum_{j} \left( \sum_{n} \frac{(-\beta E_j)^n}{n!} \right) \mathbb{P}_j = \sum_{j} e^{-\beta E_j} \mathbb{P}_j.
\]

We can find the partition function \(Z_N\) by requiring the normalization of the density operator:
\[
    \Tr_{H_N}(\rho_{c}) = 1 = \frac{1}{Z_N}\Tr(e^{-\beta H_N}) \implies Z_N = \text{Tr}_{H_N}(e^{-\beta H_N}).
\]
We can also reduce the expression for the partition function to a more familiar one using the spectral decomposition of the Hamiltonian:
\begin{equation}
    Z_N = \text{Tr}_{H_N}(e^{-\beta H_N}) = \sum_{j} e^{-\beta E_j} \text{Tr}_{H_N}(\mathbb{P}_j) = \sum_{j} g_j e^{-\beta E_j},
    \label{eq:quantum_canonical_partition_function}
\end{equation}
where \(g_j = \text{Tr}_{H_N}(\mathbb{P}_j)\) is the degeneracy of the energy level \(E_j\).

The expectation value of an observable \(A\) in the canonical ensemble is given by
\begin{equation}
    \langle A \rangle_{c} = \text{Tr}_{H_N}(\rho_{c} A) = \frac{1}{Z_N} \sum_{j} e^{-\beta E_j} \text{Tr}_{H_N}(\mathbb{P}_j A).
    \label{eq:quantum_canonical_expectation_value}
\end{equation}

Now we can compute the quantum analog of the Helmholtz free energy \(F\) in the canonical ensemble, in order to relate thermodynamic quantities to the partition function:
\[
    Z_N = e^{-\beta F} \implies F = - \frac{1}{\beta} \log Z_N.
\]
From the Helmholtz free energy, we can derive other thermodynamic quantities. For instance, the internal energy \(E\) is given by
\[
    \begin{aligned}
        E = \langle H_N \rangle_{c} & = \text{Tr}_{H_N}(\rho_{c} H_N) = \frac{1}{Z_N} \text{Tr}_{H_N}(e^{-\beta H_N} H_N)                                            \\
                                    & = \frac{-1}{Z_N} \frac{\partial}{\partial \beta} \text{Tr}_{H_N}(e^{-\beta H_N}) = - \frac{\partial}{\partial \beta} \log Z_N.
    \end{aligned}
\]

The entropy \(S\) in the canonical ensemble can be computed using the relation
\[
    \begin{aligned}
        S & = -k_B \langle \log \rho_{c} \rangle_{c} = - k_B \text{Tr}_{H_N}(\rho_{c} \log \rho_{c}) = -k_B \text{Tr}_{H_N} \left( \frac{e^{-\beta H_N}}{Z_N} (- \beta H_N - \log Z_N) \right) \\
          & = - k_B \left( -\beta \text{Tr}_{H_N}(\frac{H_N e^{-\beta H_N}}{Z_N}) + \frac{\beta F}{Z_N} \text{Tr}_{H_N}(e^{-\beta H_N}) \right)                                                \\
          & = - k_B \left( - \beta E + \beta F \right) = \frac{E - F}{T},
    \end{aligned}
\]
since \(\log Z_N = -\beta F\) and \(\text{Tr}_{H_N}(e^{-\beta H_N}) = Z_N\). This result is consistent with the thermodynamic, confirming the validity of our quantum statistical mechanics framework.

\section{Grand Canonical Ensemble}

In the grand canonical ensemble, we consider a quantum system that can exchange both energy and particles with a reservoir. The system is characterized by a fixed temperature \(T\), volume \(V\), and chemical potential \(\mu\). The number of particles \(N\) in the system can fluctuate, so we work in the Fock space
\[
    \mathcal{F} = \bigoplus_{N=0}^{\infty} \mathcal{H}^{(N)}_{S/A}.
\]

The Hamiltonian operator \(H\) in the grand canonical ensemble acts on the Fock space, and it is the combination of the Hamiltonians for different particle numbers acting on their respective Hilbert spaces; thus we have the number operator \(N\) that commutes with the Hamiltonian at fixed \(N\) (canonical Hamiltonian \(H_N\)), while the full Hamiltonian \(H\) will respect
\[
    H \ket{\psi_{j,\,\alpha}}^{(N)} = E_{j}^{(N)} \ket{\psi_{j,\,\alpha}}^{(N)},
\]
where the ON base \(\{\ket{\psi_{j,\,\alpha}}^{(N)}\}_{j,\,\alpha,\,N}\) spans the Fock space, with \(\alpha\) indexing the degeneracy of each energy level \(E_{j}^{(N)}\) for a fixed number of particles \(N\). Thus we have projectors in the Fock space \(\mathbb{P}_{j}^{(N)} = \sum_{\alpha=1}^{g_{j}^{(N)}} \ket{\psi_{j,\,\alpha}}^{(N)} \bra{\psi_{j,\,\alpha}}^{(N)}\) which are \(N\) dipendent and orthogonal in each index. Finally we can express the Hamiltonian in terms of its spectral decomposition:
\[
    H = \sum_{N}\sum_{j} E_j^{(N)} \mathbb{P}_j^{(N)}.
\]

The density operator for a mixed state in the grand canonical ensemble is given by
\[
    \rho_{gc} = \sum_{N} \sum_{j} p_j^{(N)} \mathbb{P}_j^{(N)},
\]
where, since we are mimicking the classical ensamble, the probabilities \(p_j^{(N)}\) are determined by the Boltzmann factors, taking into account both energy and particle number: \(p_j^{(N)} \propto e^{-\beta (E_j^{(N)} - \mu N)}\). Thus we can write the density operator as
\begin{equation}
    \rho_{gc} = \frac{1}{\mathcal{Z}} \sum_{N} \sum_{j} e^{-\beta (E_j^{(N)} - \mu N)} \mathbb{P}_j^{(N)} = \frac{1}{\mathcal{Z}} e^{-\beta (H - \mu N)},
    \label{eq:grand_canonical_density_operator}
\end{equation}
where we need to make some considerations:
\begin{itemize}
    \item \(\sum_{N} \left(\sum_{j} e^{-\beta (E_j^{(N)})} \mathbb{P}_j^{(N)}\right) = e^{-\beta H}\), since we are summing over all possible particle numbers and energy levels, reconstructing the full Hamiltonian operator acting on the Fock space (the computation is almost identical to the canonical case);
    \item \(\sum_{N} \left(\sum_{j} e^{\beta \mu N} \mathbb{P}_j^{(N)}\right) = e^{\beta \mu N}\), since the number operator \(N\) acts on the Fock space and counts the number of particles in each state (again, it is the same computation as before);
    \item the normalization factor \(\frac{1}{\mathcal{Z}}\) is the grand partition function, ensuring that the density operator is properly normalized.
\end{itemize}

We will spend some words on the computation of the grand partition function \(\mathcal{Z}\): it is defined by the unitary condition on the density operator trace
\[
    \begin{aligned}
        \Tr_{\mathcal{F}}(\rho_{gc}) & = \sum_{N=0}^{\infty} \Tr_{\mathcal{H}_N} \left( \frac{1}{\mathcal{Z}} e^{-\beta (H - \mu N)} \right) = \frac{1}{\mathcal{Z}} \sum_{N=0}^{\infty} e^{\beta \mu N} \Tr_{\mathcal{H}_N}(e^{-\beta H_N}) \\
                                     & = \frac{1}{\mathcal{Z}} \sum_{N=0}^{\infty} z^N Z_N, = 1
    \end{aligned}
\]
where we used the fact that the trace over the Fock space can be decomposed into traces over the fixed particle number Hilbert spaces \(\mathcal{H}_N\), and we recognized the canonical partition function \(Z_N = \Tr_{\mathcal{H}_N}(e^{-\beta H_N})\) and the fugacity \(z = e^{\beta \mu}\). Therefore, we find that the grand partition function is given by
\begin{equation}
    \mathcal{Z} = \sum_{N=0}^{\infty} z^N Z_N = \sum_{N=0}^{\infty} z^N \Tr_{\mathcal{H}_N}(e^{-\beta H_N}) = \Tr_{\mathcal{F}}(e^{-\beta (H - \mu N)}).
    \label{eq:grand_partition_function}
\end{equation}

The expectation value of an observable \(A\) in the grand canonical ensemble is given by
\begin{equation}
    \langle A \rangle_{gc} = \Tr_{\mathcal{F}}(\rho_{gc} A) = \frac{1}{\mathcal{Z}} \sum_{N=0}^{\infty} z^N \Tr_{\mathcal{H}_N}(e^{-\beta H_N} A),
    \label{eq:grand_canonical_expectation_value}
\end{equation}
where the observable considered must act on the Fock space and commute with the number operator \(N\) on each \(\mathcal{H}_N\).

From all this tools, we can compute the quantum analog of the grand potential \(\Omega\) in the grand canonical ensemble:
\[
    \mathcal{Z} = e^{-\beta \Omega} \implies \Omega = - \frac{1}{\beta} \log \mathcal{Z}.
\]

For the other thermodynamic quantities, we could derive them from the grand potential, but it is more instructive to show how to compute them directly from the grand partition function, at least for the internal energy \(E\) and the grand canonical entropy \(S\).

The internal energy \(E\) in the grand canonical ensemble is given by
\[
    \begin{aligned}
        E - \mu N = \langle H - \mu N \rangle_{gc} & = \Tr_{\mathcal{F}}(\rho_{gc} (H - \mu N)) = \frac{1}{\mathcal{Z}} \Tr_{\mathcal{F}}(e^{-\beta (H - \mu N)} (H - \mu N))                                 \\
                                                   & = \frac{-1}{\mathcal{Z}} \frac{\partial}{\partial \beta} \Tr_{\mathcal{F}}(e^{-\beta (H - \mu N)}) = - \frac{\partial}{\partial \beta} \log \mathcal{Z}.
    \end{aligned}
\]

The entropy \(S\) in the grand canonical ensemble can be computed as
\[
    \begin{aligned}
        S & = - k_B \langle \log \rho_{gc} \rangle_{gc} = - k_B \Tr_{\mathcal{F}}(\rho_{gc} \log \rho_{gc}) = - k_B \Tr_{\mathcal{F}} \left( \frac{e^{-\beta (H - \mu N)}}{\mathcal{Z}} (-\beta (H - \mu N) - \log \mathcal{Z}) \right) \\
          & = - k_B \left( -\beta \Tr_{\mathcal{F}} \left( \frac{(H - \mu N) e^{-\beta (H - \mu N)}}{\mathcal{Z}} \right) + \frac{\beta \Omega}{\mathcal{Z}} \Tr_{\mathcal{F}}(e^{-\beta (H - \mu N)}) \right)                          \\
          & = - k_B \left( -\beta (E - \mu N) + \beta \Omega \right) = \frac{E - \mu N - \Omega}{T}.
    \end{aligned}
\]

\section{Quantum Gases}

Quantum gases are systems of non-interacting or weakly interacting particles that obey quantum statistics. Depending on the nature of the particles, they can be classified as either bosons or fermions, leading to different statistical behaviors.

A quantum gas can be described using the grand canonical ensemble, where the number of particles can fluctuate, and the system is characterized by a fixed temperature \(T\), volume \(V\), and chemical potential \(\mu\); the Hamiltonian operator for a quantum gas of non-interacting particles can be expressed, for a fixed \(N\), as
\[
    \hat{H} = \sum_{i}^N \hat{\mathcal{O}}_i = \sum_{i}^N \left( \frac{\hat{p}_i^2}{2m} + U(\hat{q}_i) \right),
\]
where \(\hat{\mathcal{O}}_i\) is the single-particle operator, \(\hat{p}_i\) and \(\hat{q}_i\) are the momentum and position operators of the \(i\)-th particle, \(m\) is the mass of the particles, and \(U(\hat{q}_i)\) is the potential energy operator acting on the position of the \(i\)-th particle.

In second quantization, we can express the Hamiltonian operator in terms of creation and annihilation operators \(\hat{a}_{\alpha}^{\dagger}\) and \(\hat{a}_{\alpha}\) for the single-particle states:
\[
    \hat{H} = \sum_{\alpha \beta} t_{\alpha \beta} \hat{a}_{\alpha}^{\dagger} \hat{a}_{\beta},
\]
where the ladder operators satisfy the appropriate commutation or anticommutation relations depending on whether the particles are bosons or fermions: the nature of the particles determines the algebra of the creation and annihilation operators, which in turn affects the statistical properties of the quantum gas.
Looking at the ON base for the single-particle Hamiltonian \(\hat{\mathcal{O}}\), we can deduce a more useful form for our hamiltonian, diagonalized in terms of single-particle energy eigenstates \(\ket{e_{\alpha}}\) with eigenvalues \(\epsilon_{\alpha}\):
\[
    \hat{\mathcal{O}} \ket{e_{\alpha}} = \epsilon_{\alpha} \ket{e_{\alpha}},
\]
so that the full Hamiltonian operator can be expressed as
\[
    \hat{H} = \sum_{\alpha} \epsilon_{\alpha} \hat{a}_{\alpha}^{\dagger} \hat{a}_{\alpha},
\]
where \(\hat{a}_{\alpha}^{\dagger}\) and \(\hat{a}_{\alpha}\) are the creation and annihilation operators for the single-particle state \(\ket{e_{\alpha}}\), forming the number operator \(\hat{n}_{\alpha} = \hat{a}_{\alpha}^{\dagger} \hat{a}_{\alpha}\) that counts the number of particles in the state \(\ket{e_{\alpha}}\).

Thus we can define
\[
    \hat{H} - \mu \hat{N} = \sum_{\alpha} (\epsilon_{\alpha} - \mu) \hat{n}_{\alpha},
\]
where \(\hat{N} = \sum_{\alpha} \hat{n}_{\alpha}\) is the total number operator for the system.
The density operator for the quantum gas in the grand canonical ensemble is given by
\[
    \hat{\rho}_{gc} = \frac{1}{\mathcal{Z}} e^{-\beta (\hat{H} - \mu \hat{N})} = \frac{1}{\mathcal{Z}} e^{-\beta \sum_{\alpha} (\epsilon_{\alpha} - \mu) \hat{n}_{\alpha}},
\]
and the grandcanonical partition function can be computed as
\[
    \mathcal{Z} = \Tr_{\mathcal{F}}(e^{-\beta (\hat{H} - \mu \hat{N})}) = \Tr_{\mathcal{F}} \left( e^{-\beta \sum_{\alpha} (\epsilon_{\alpha} - \mu) \hat{n}_{\alpha}} \right),
\]
where we can construct the Fock space \(\mathcal{F}\) as the tensor product of the single-particle state spaces:
\[
    \ket{n_{1}, n_{2}, \ldots} = C (\hat{a}_{1}^{\dagger})^{n_1} (\hat{a}_{2}^{\dagger})^{n_2} \cdots \ket{0},
\],
with \(C\) a normalization constant and \(\ket{0}\) the vacuum state. The occupation numbers \(n_{\alpha}\) indicate how many particles occupy the single-particle state \(\ket{e_{\alpha}}\). Now we can compute the grand partition function exploiting the trace
\[
    \begin{aligned}
        \mathcal{Z} & = \sum_{n_1=0}^{n_{\text{max}}} \sum_{n_2=0}^{n_{\text{max}}} \cdots \bra{n_1, n_2, \ldots} e^{-\beta \sum_{\alpha} (\epsilon_{\alpha} - \mu) \hat{n}_{\alpha}} \ket{n_1, n_2, \ldots}                           \\
                    & = \sum_{n_1,\,n_2,\,\cdots} e^{-\beta \sum_{\alpha} (\epsilon_{\alpha} - \mu) n_{\alpha}} \bra{n_1, n_2, \ldots} \ket{n_1, n_2, \ldots}                                                                          \\
                    & = \sum_{n_1,\,n_2,\,\cdots} \prod_{\alpha} e^{-\beta (\epsilon_{\alpha} - \mu) n_{\alpha}} = \prod_{\alpha} \left( \sum_{n_{\alpha}=0}^{n_{\text{max}}} e^{-\beta (\epsilon_{\alpha} - \mu) n_{\alpha}} \right),
    \end{aligned}
\]
where we swapped the sums and products since the indices are independent (note how the sum changed index). The upper limit \(n_{\text{max}}\) of the sums over occupation numbers depends on the nature of the particles:
\begin{itemize}
    \item for bosons, \(n_{\text{max}} = \infty\), since multiple bosons can occupy the same quantum state;
    \item for fermions, \(n_{\text{max}} = 1\), due to the Pauli exclusion principle, which states that no two fermions can occupy the same quantum state simultaneously.
\end{itemize}

\subsection{Quantum Statistics}

We can now derive the specific forms of the grand partition function and related thermodynamic quantities for fermionic and bosonic quantum gases.
We need to compute the sum over occupation numbers for each case, rememnbering that we cannot accept divergences to infinity in the partition function, since it must be finite and well defined (imagine trying to compute the TD limit).

\paragraph{Fermionic case.}
For fermions, the occupation numbers \(n_{\alpha}\) can only take values 0 or 1. Therefore, the sum over occupation numbers for each single-particle state \(\alpha\) gives the following result grand partition function:
\[
    \mathcal{Z}_{F} = \prod_{\alpha} \left( \sum_{n_{\alpha}=0}^{1} e^{-\beta (\epsilon_{\alpha} - \mu) n_{\alpha}} \right) = \prod_{\alpha} \left( 1 + e^{-\beta (\epsilon_{\alpha} - \mu)} \right).
\]
From the grand partition function, we can derive the grand potential \(\Omega_F\) for the fermionic quantum gas, in order to relate thermodynamic quantities to the partition function:
\[
    \Omega_F = - \frac{1}{\beta} \log \mathcal{Z}_F = - \frac{1}{\beta} \sum_{\alpha} \log \left( 1 + e^{-\beta (\epsilon_{\alpha} - \mu)} \right).
\]
Now it is time to compute the average occupation number \(\langle n_{\alpha} \rangle\) for each single-particle state \(\alpha\) in the fermionic quantum gas. This quantity represents the expected number of particles occupying the state \(\ket{e_{\alpha}}\), and it's the core of \textbf{Fermi-Dirac statistics}:\footnote{The computation will be done after some result from the Bosonic case.}
\begin{equation}
    \langle n_{\alpha} \rangle_{F} = \frac{1}{e^{\beta (\epsilon_{\alpha} - \mu)} + 1}.
    \label{eq:fermi_dirac_distribution}
\end{equation}

\paragraph{Bosonic case.}
For bosons, the occupation numbers \(n_{\alpha}\) can take any non-negative integer value (0, 1, 2, ...). Therefore, the sum over occupation numbers for each single-particle state \(\alpha\) gives the following result for the grand partition function:
\[
    \mathcal{Z}_{B} = \prod_{\alpha} \left( \sum_{n_{\alpha}=0}^{\infty} e^{-\beta (\epsilon_{\alpha} - \mu) n_{\alpha}} \right) = \prod_{\alpha} \frac{1}{1 - e^{-\beta (\epsilon_{\alpha} - \mu)}},
\]
where we used the formula for the sum of a geometric series.\footnote{It is crucial that the series converges, it's not guaranteed for all values of \(\mu\) and \(\epsilon_{\alpha}\), and surely it's not only a way to reconduce to a prettier mathematical expression, as we will highlight.} Since the geometric series \(\sum_{n}x^n = \frac{1}{1-x}\) converges only for values of \(x < 1\), we get a prescription on the exponent:
\[
    e^{-\beta(\epsilon_{\alpha} - \mu)} < 1 \iff \epsilon_{\alpha} - \mu > 0 \iff \mu < \min_{\alpha}\{\epsilon_{\alpha}\},
\]
meaning that, since we can take \(\min_{\alpha}\{\epsilon_{\alpha}\} = 0\), the chemical potential \(\mu\) must be negative for the bosonic quantum gas to ensure convergence of the grand partition function; this condition has important physical implications, especially when considering phenomena like \textbf{Bose-Einstein condensation}.
From the grand partition function, we can derive the grand potential \(\Omega_B\) for the bosonic quantum gas:
\[
    \Omega_B = - \frac{1}{\beta} \log \mathcal{Z}_B = \frac{1}{\beta} \sum_{\alpha} \log \left( 1 - e^{-\beta (\epsilon_{\alpha} - \mu)} \right).
\]
Finally we get to derive the \textbf{Bose-Einstein statistics}, computing the average occupation number \(\langle n_{\alpha} \rangle\) for each single-particle state \(\alpha\) in the bosonic quantum gas:
\begin{equation}
    \langle n_{\alpha} \rangle_{B} = \frac{1}{e^{\beta (\epsilon_{\alpha} - \mu)} - 1}.
    \label{eq:bose_einstein_distribution}
\end{equation}

It is good practice to compact the expressions for the two different statistics in a single formula: from the grand partition function
\begin{equation}
    \mathcal{Z}_{B/F} = \prod_{\alpha} \left(1 \mp e^{-\beta(\epsilon_{\alpha} -\mu)}\right)^{\mp 1},
    \label{eq:quantum_gas_grandpartition}
\end{equation}
where the upper sign refers to bosons and the lower sign to fermions. Fo the grandpotential we have
\begin{equation}
    \Omega_{B/F} = \mp \frac{1}{\beta} \sum_{\alpha} \log \left(1 \pm e^{-\beta(\epsilon_{\alpha} - \mu)}\right),
    \label{eq:quantum_gas_grand_potential}
\end{equation}
and finally we are able to compute explucitly the average occupation number for both statistics at the same time:
\[
    \begin{aligned}
        \langle \hat{n}_{\alpha} \rangle^{B/F}_{gc} & = \Tr_{\mathcal{F}}(\rho_{gc} \hat{n}_{\alpha}) = \frac{1}{\mathcal{Z}_{B/F}} \Tr_{\mathcal{F}} \left( e^{-\beta (\hat{H} - \mu \hat{N})} \hat{n}_{\alpha} \right)                                      \\
                                                    & = \frac{1}{\mathcal{Z}_{B/F}} \Tr _{\mathcal{F}} \left( e^{-\beta \sum_{\gamma} (\epsilon_{\gamma} - \mu) \hat{n}_{\gamma}} \hat{n}_{\alpha} \right)                                                    \\
                                                    & = \frac{-1}{\beta\mathcal{Z}_{B/F}} \Tr_{\mathcal{F}}\left(\frac{\partial}{\partial \epsilon_{\alpha}} e^{-\beta \sum_{\gamma}(\epsilon_{\gamma} - \mu) \hat{n}_{\gamma}}\right)                        \\
                                                    & = \frac{-1}{\beta} \frac{\partial}{\partial \epsilon_{\alpha}} \log \mathcal{Z}_{B/F} = \frac{\partial}{\partial \epsilon_{\alpha}} \Omega_{B/F} = \frac{1}{e^{\beta (\epsilon_{\alpha} - \mu)} \mp 1},
    \end{aligned}
\]
where again the upper sign refers to bosons and the lower sign to fermions, recovering equations \eqref{eq:fermi_dirac_distribution} and \eqref{eq:bose_einstein_distribution}. We can now interpret these results: the average occupation number \(\langle n_{\alpha} \rangle\) gives the expected number of particles occupying the single-particle state \(\ket{e_{\alpha}}\) at thermal equilibrium. The difference in the denominators reflects the fundamental distinction between bosons and fermions:
\begin{itemize}
    \item For bosons, the minus sign in the denominator allows for the possibility of multiple particles occupying the same quantum state, leading to phenomena like Bose-Einstein condensation, where a macroscopic number of bosons can occupy the ground state at low temperatures.
    \item For fermions, the plus sign in the denominator enforces the Pauli exclusion principle, which prohibits multiple fermions from occupying the same quantum state. This leads to the characteristic filling of energy levels up to the Fermi energy at absolute zero temperature.
\end{itemize}

It is also interesting to analyze the behavior of these distributions compared to the classical Maxwell-Boltzmann distribution.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{img/Quantum_and_classical_statistics.png}
    \caption{\small Comparison of quantum statistics (Fermi-Dirac and Bose-Einstein) with classical Maxwell-Boltzmann statistics. The plot illustrates how the average occupation number \(\langle n_{\alpha} \rangle\) varies with energy \(\epsilon_{\alpha}\) for different temperatures \(T\) and chemical potentials \(\mu\). At high energies or low densities, all three distributions converge, reflecting classical behavior. However, at low energies or high densities, quantum effects become significant, leading to deviations from classical predictions. Notably, the Bose-Einstein distribution allows for a divergence in occupation number as energy approaches the chemical potential, indicating the onset of Bose-Einstein condensation. In contrast, the Fermi-Dirac distribution approaches a maximum occupation of 1 due to the Pauli exclusion principle.}
    \label{fig:quantum_statistics_comparison}
\end{figure}

Let us compute the internal energy \(E\) of the quantum gas using the average occupation numbers derived above:
\[
    \begin{aligned}
        E & = \langle \hat{H} \rangle^{B/F}_{gc} = \Tr_{\mathcal{F}}(\rho_{gc} \hat{H}) = \frac{1}{\mathcal{Z}_{B/F}} \Tr_{\mathcal{F}} \left( e^{-\beta (\hat{H} - \mu \hat{N})} \hat{H} \right) \\
          & = - \frac{\partial}{\partial \beta} \log \mathcal{Z}_{B/F} \big\vert_z,
    \end{aligned}
\]
where the subscript \(\big\vert_z\) indicates that the derivative is taken at constant fugacity \(z = e^{\beta \mu}\). Expanding this expression, we have
\[
    \begin{aligned}
        E & = \frac{1}{\mathcal{Z}_{B/F}} \Tr_{\mathcal{F}} \left( e^{-\beta \sum_{\alpha} (\epsilon_{\alpha} - \mu) \hat{n}_{\alpha}} \sum_{\alpha} \epsilon_{\alpha} \hat{n}_{\alpha} \right) \\
          & = \sum_{\alpha} \epsilon_{\alpha} \left( \frac{1}{\mathcal{Z}_{B/F}} \Tr_{\mathcal{F}} \left( e^{-\beta (\hat{H} - \mu \hat{N})} \hat{n}_{\alpha} \right) \right)                   \\
          & = \sum_{\alpha} \epsilon_{\alpha} \langle \hat{n}_{\alpha} \rangle^{B/F}_{gc} = \sum_{\alpha} \frac{\epsilon_{\alpha}}{e^{\beta (\epsilon_{\alpha} - \mu)} \mp 1}.
    \end{aligned}
\]
So the internal energy of the quantum gas can be expressed as a sum over all single-particle states, weighted by their respective energies and average occupation numbers according to either Bose-Einstein or Fermi-Dirac statistics
\begin{equation}
    \langle \hat{H} \rangle^{B/F}_{gc} = \sum_{\alpha} \frac{\epsilon_{\alpha}}{e^{\beta (\epsilon_{\alpha} - \mu)} \mp 1},
    \label{eq:quantum_gas_internal_energy}
\end{equation}
where we have not made any assumptions about the specific form of the single-particle energy levels \(\epsilon_{\alpha}\); this expression is quite general and can be applied to various quantum gas systems, including those confined in different potentials or geometries. Let us now specialize to the case of non-relativistic 3D quantum gases confined in a cubic box of volume \(V = L^3\) with periodic boundary conditions.

\subsection{Non Relativistic 3D Quantum Gases}

For a non-relativistic quantum gas confined in a cubic box of volume \(V = L^3\) with periodic boundary conditions, the single-particle energy levels \(\epsilon_{\alpha}\) can be expressed in terms of the kinetic energy of the particles
\[
    \epsilon_{\mathbf{k}} = \frac{p^2}{2m} = \frac{\hbar^2 k^2}{2m},
\]
from the solution of the SchrÃ¶dinger equation for a free particle in a box:
\[
    - \frac{\hbar^2 \nabla^2}{2m} \ket{\psi} = \epsilon \ket{\psi}.
\]
The allowed wavevectors \(\mathbf{k}\) are quantized due to the boundary conditions, leading to discrete energy levels given by
\[
    \mathbf{k} = \frac{2\pi}{L} (n_x, n_y, n_z), \quad n_x, n_y, n_z \in \mathbb{Z},
\]
so that the energy levels can be rewritten as
\[
    \epsilon_{\mathbf{k}} = \frac{\hbar^2}{2m} (k_x^2 + k_y^2 + k_z^2) \implies \epsilon_{\mathbf{n}} = \frac{\hbar^2}{2m} \left( \frac{2\pi}{L} \right)^2 (n_x^2 + n_y^2 + n_z^2).
\]

The key thermodynamic quantities for the quantum gas can be computed using the expressions derived earlier, substituting the specific form of the energy levels \(\epsilon_{\mathbf{n}}\): from the grand partition function
\[
    \mathcal{Z}_{B/F} = \prod_{\mathbf{n}} \left(1 \mp e^{-\beta(\epsilon_{\mathbf{n}} -\mu)}\right)^{\mp g},
\]
where \(g\) is the discrete degeneracy factor accounting for internal degrees of freedom (e.g., spin), we can derive the grand potential, internal energy, and average number of particles:
\[
    \begin{aligned}
        \Omega_{B/F} & = \pm \frac{g}{\beta} \sum_{\mathbf{n}} \log \left( 1 \mp e^{-\beta (\epsilon_{\mathbf{n}} - \mu)} \right), \\
        E_{B/F}      & = g\sum_{\mathbf{n}} \frac{\epsilon_{\mathbf{n}}}{e^{\beta (\epsilon_{\mathbf{n}} - \mu)} \mp 1},           \\
        N_{B/F}      & = g\sum_{\mathbf{n}} \frac{1}{e^{\beta (\epsilon_{\mathbf{n}} - \mu)} \mp 1}.
    \end{aligned}
\]

If we now consider the thermodynamic limit, where the volume \(V\) goes to infinity while keeping the particle density \(N/V\) constant, we can replace the sums over discrete states with integrals over continuous momentum space.
\[
    \sum_{\mathbf{k}} \to \sum_{\mathbf{n}} \xrightarrow{TD} (?)
\]
In order to perform this substitution, we need to determine the density of states in momentum space. The strategy is to look at the volume element in \(\mathbf{k}\)-space corresponding to each quantum state
\[
    \Delta k_j = \frac{2\pi}{L} \left((n_j + 1) - n_j \right) = \frac{2\pi}{L} \implies \Delta k_x \Delta k_y \Delta k_z = \left( \frac{2\pi}{L} \right)^3 = \frac{(2\pi)^3}{V},
\]
which in the thermodynamic limit becomes infinitesimal \(L \to \infty \implies \Delta k_j \to 0\). Therefore, the number of states in a volume element \(d^3k\) in \(\mathbf{k}\)-space is given by
\[
    \sum_{\mathbf{n}} \frac{\hbar^2}{2m} \left(\frac{2\pi}{L}\right)^3 (\Delta n_x)(\Delta n_y)(\Delta n_z) \longrightarrow \sum_{\mathbf{k}} \frac{V}{(2\pi)^3} (\Delta k_x) (\Delta k_y) (\Delta k_z),
\]
where we know that \((\Delta n_x)(\Delta n_y)(\Delta n_z) = 1\) since we are counting each discrete state and \((\Delta k_x)(\Delta k_y)(\Delta k_z)\) is the infinitesimal volume \(\mathrm{d}^3\mathbf{k}\) element in \(\mathbf{k}\)-space. Thus we pass from the sum over discrete states to an integral over continuous momentum space as
\[
    \sum_{\mathbf{k}} \longrightarrow \frac{V}{(2\pi)^3} \int \mathrm{d}^3 \mathbf{k}.
\]
We can use polar coordinates in momentum space, since the energy levels depend only on the magnitude of the wavevector \(k = |\mathbf{k}|\), leading to
\[
    \int \mathrm{d}^3 \mathbf{k} = 4\pi \int_0^{\infty} k^2 \mathrm{d}k \implies \sum_{\mathbf{k}} \longrightarrow \frac{V}{(2\pi)^3} 4\pi \int_0^{\infty} k^2 \mathrm{d}k = \frac{V}{2\pi^2} \int_0^{\infty} k^2 \mathrm{d}k.
\]
The final step is to change the integration variable from \(k\) to the energy \(\epsilon\), using the relation \(\epsilon = \frac{\hbar^2 k^2}{2m}\), which gives
\[
    k^2 \mathrm{d} k \to \left(\frac{2m}{\hbar^2}\right)^{3/2} \frac{\epsilon^{\tfrac12}}{2} \mathrm{d} \epsilon,
\]
so that we can express the sum over states as
\[
    \sum_{\mathbf{k}} \longrightarrow \frac{V}{2\pi^2} \left(\frac{2m}{\hbar^2}\right)^{3/2} \frac{1}{2} \int_0^{\infty} \epsilon^{\tfrac12} \mathrm{d} \epsilon = V \int g(\epsilon) \mathrm{d} \epsilon.
\]
Here, we have introduced the \textbf{density of states} \(g(\epsilon)\) for a non-relativistic 3D quantum gas, defined as
\begin{equation}
    g(\epsilon) = \frac{g}{4\pi^2} \left( \frac{2m}{\hbar^2} \right)^{3/2} \epsilon^{1/2} = A \epsilon^{1/2},
    \label{eq:3d_free_quantum_gas_density_of_states}
\end{equation}
which gives the number of available quantum states per unit energy interval at energy \(\epsilon\), where we have included the discrete degeneracy factor \(g\) from the internal degrees of freedom. For a generic system, the strategy to compute the density of states \(g(\epsilon)\) involves finding the relationship between the energy levels and the quantum numbers characterizing the states, then determining how many states fall within a given energy range (compute the volume in quantum number space corresponding to that energy range).

For a generic thermodynamic quantity that can be expressed as a sum over states \(\sum_{\alpha} f(\epsilon_{\alpha})\), we can now write it as an integral over energy using the density of states:
\[
    \sum_{\alpha} f(\epsilon_{\alpha}) \longrightarrow V \int_0^{\infty} g(\epsilon) f(\epsilon) \mathrm{d} \epsilon,
\]
so that we can express the grand potential, internal energy, and average number of particles for the non-relativistic 3D quantum gas in the thermodynamic limit as\footnote{Remember that the internal degeneracy factor \(g\) has already been included in the density of states \(g(\epsilon)\).}
\[
    \begin{aligned}
        \Omega_{B/F} & = \pm \frac{V}{\beta} \int_0^{\infty} g(\epsilon) \log \left( 1 \mp e^{-\beta (\epsilon - \mu)} \right) \mathrm{d} \epsilon, \\
        E_{B/F}      & = V \int_0^{\infty} g(\epsilon) \frac{\epsilon}{e^{\beta (\epsilon - \mu)} \mp 1} \mathrm{d} \epsilon,                       \\
        N_{B/F}      & = V \int_0^{\infty} g(\epsilon) \frac{1}{e^{\beta (\epsilon - \mu)} \mp 1} \mathrm{d} \epsilon.
    \end{aligned}
\]
These integrals can be evaluated using special functions, such as the polylogarithm function or power series, to obtain explicit expressions for the thermodynamic quantities of interest in terms of temperature, chemical potential, and volume.

Now, by some developments of these expressions, we can get interesting results and laws.

\paragraph{Equation of state.}
If we integrate by part the expression for the grandpotential \(\Omega_{B/F}\), we get
\[
    \begin{aligned}
        \Omega_{B/F} & = \pm \frac{AV}{\beta} \left[ \frac{2}{3} \epsilon^{\tfrac32} \log \left( 1 \mp e^{-\beta (\epsilon - \mu)} \right) \Big\vert_0^{\infty} \mp \int_0^{\infty} \frac{2}{3}\epsilon^{\tfrac32} \frac{\pm \beta e^{-\beta (\epsilon - \mu)}}{1 \mp e^{-\beta (\epsilon - \mu)}} \mathrm{d} \epsilon \right]                \\
                     & \qquad  \lim_{\epsilon \to \infty} \log(1 \mp 0) = 0 \quad \text{and} \quad \epsilon^{\tfrac32} \log(1 \mp e^{\beta \mu}) \Big\vert_{\epsilon = 0} = 0,                                                                                                                                                                \\
                     & \qquad A \tfrac{2}{3} \epsilon^{\tfrac32} = \tfrac{2}{3} \epsilon g(\epsilon),                                                                                                                                                                                                                                         \\
                     & = \mp \frac{V}{\beta} (\pm \beta) \frac{2}{3}\int_0^{\infty}g(\epsilon) \frac{\epsilon e^{-\beta (\epsilon - \mu)}}{1 \mp e^{-\beta (\epsilon - \mu)}} \mathrm{d} \epsilon = - \frac{2}{3} V \int_0^{\infty} g(\epsilon) \frac{\epsilon}{e^{\beta (\epsilon - \mu)} \mp 1} \mathrm{d} \epsilon = - \frac{2}{3}E_{B/F},
    \end{aligned}
\]
where we used the expression for the internal energy \(E_{B/F}\) in the last step. Thus we have derived an important relation between the grand potential and the internal energy for a non-relativistic 3D quantum gas: since the pressure \(p\) is related to the grand potential by \(p = - \frac{\Omega}{V}\), we can express the equation of state for the quantum gas as
\[
    pV = \frac{2}{3} E_{B/F}.
\]

\paragraph{Power series expansion.}
Now we have expressions for the thermodynamic quantities as integrals over energy, we can evaluate these integrals using power series expansions. We will analyze the average number of particles \(N_{B/F}/V = n_{B/F}\) and the pressure \(p_{B/F}\) in detail
\[
    \begin{aligned}
        n_{B/F} & = A \int_0^{\infty} \frac{\epsilon^{\tfrac12}}{e^{\beta (\epsilon - \mu)} \mp 1} \mathrm{d} \epsilon,             \\
        p_{B/F} & = \frac{2}{3} A \int_0^{\infty} \frac{\epsilon^{\tfrac32}}{e^{\beta (\epsilon - \mu)} \mp 1} \mathrm{d} \epsilon.
    \end{aligned}
\]
The idea is to perform a change of variable, since these expressions are impossible to evaluate directly written in this form (we will not get a simple solution, but a form from which it will be easy at least to compute the limits in temperature). Let us define the fugacity \(z = e^{\beta \mu}\) and perform the change
\[
    \beta \epsilon = x^2 \implies \beta \mathrm{d} \epsilon = 2x \mathrm{d}x,
\]
which will let us find a power series and also gaussian integrals, as we will show. Thus, it is possible to rewrite the expressions for the particle density and pressure as
\[
    \begin{aligned}
        n_{B/F} & = \mathcal{C} \int_0^{\infty} \frac{z x^2}{e^{x^2} \mp z} \mathrm{d} x = \mathcal{C} \int_0^{\infty} \frac{z x^2e^{-x^2}}{1 \mp ze^{-x^2}} \mathrm{d} x,                                 \\
        p_{B/F} & = \frac{2}{3\beta} \mathcal{C} \int_0^{\infty} \frac{zx^4}{e^{x^2} \mp z} \mathrm{d} x = \frac{2}{3\beta} \mathcal{C} \int_0^{\infty} \frac{zx^4e^{-x^2}}{1 \mp ze^{-x^2}} \mathrm{d} x,
    \end{aligned}
\]
where we have defined the constant\footnote{It comes from the change of variable, which left us with \(\frac{2A}{\beta^{3/2}} = 2 \frac{g}{4\pi^2} \left( \frac{2m}{\hbar^2} \right)^{3/2} \beta^{-3/2}\).}
\[
    \mathcal{C} = \frac{4g}{\sqrt{\pi}} \frac{1}{\lambda_{T}^3}, \quad \lambda_{T} = \sqrt{\frac{2\pi \hbar^2}{mk_B T}}.
\]
In both integrals we find the term \(\frac{z e^{-x^2}}{e^{-x^2}\mp z}\), which we can expand as a power series in \(z e^{-x^2}\) paying attention to the convergence conditions and the signs:
\begin{itemize}
    \item for bosons, we have
          \[
              \frac{z e^{-x^2}}{1 - z e^{-x^2}} = z e^{-x^2}\sum_{l=1}^{\infty} (z e^{-x^2})^l = \sum_{l=1}^{\infty} (z e^{-x^2})^{l+1},
          \]
          which converges for \(\vert z e^{-x^2} \vert < 1\), always true since \(z < 1\) for bosons;
    \item for fermions, we have
          \[
              \frac{z e^{-x^2}}{1 + z e^{-x^2}} = z e^{-x^2}\sum_{l=1}^{\infty} (-1)^{l} (z e^{-x^2})^l = \sum_{l=1}^{\infty} (-1)^{l} (z e^{-x^2})^{l+1},
          \]
          which converges for all \(z \notin ]-\infty,\, -1]\) for the alternating series, but since for fermions \(z > 0\) it always converges;
    \item we can thus write a single expression for both cases:
          \[
              \frac{z e^{-x^2}}{e^{-x^2} \mp z} = \sum_{l=1}^{\infty} (\pm 1)^{l} (z e^{-x^2})^{l+1}.
          \]
\end{itemize}
Substituting this series expansion into the integrals for \(n_{B/F}\) and \(p_{B/F}\), we get
\[
    \begin{aligned}
        n_{B/F} & = \mathcal{C} \sum_{l=1}^{\infty} (\pm 1)^{l} z^{l+1} \int_0^{\infty} x^2 e^{-(l+1)x^2} \mathrm{d} x,                  \\
        p_{B/F} & = \frac{2}{3\beta} \mathcal{C} \sum_{l=1}^{\infty} (\pm 1)^{l} z^{l+1} \int_0^{\infty} x^4 e^{-(l+1)x^2} \mathrm{d} x.
    \end{aligned}
\]
The integrals appearing in these expressions are standard gaussian integrals, which can be computed using the formula
\[
    \int_0^{\infty} x^{2n} e^{-ax^2} \mathrm{d} x = \frac{(2n-1)!!}{2^{n+1}} \sqrt{\frac{\pi}{a^{2n+1}}}, \quad a > 0,
\]
where \((x)!! = (x)(x - 2) \cdots 3 \cdot 1\) is the double factorial\footnote{Starting from \(2n-1\) we know it is an odd number and thus the product goes down by 2 each time until the unity.}. Applying this formula to our integrals, we find
\[
    \begin{aligned}
        \int_0^{\infty} x^2 e^{-(l+1)x^2} \mathrm{d} x & = \frac{\sqrt{\pi}}{2}\frac{1}{(l+1)^{3/2}},     \\
        \int_0^{\infty} x^4 e^{-(l+1)x^2} \mathrm{d} x & = \frac{3 \sqrt{\pi}}{8} \frac{1}{(l+1)^{5/2} }.
    \end{aligned}
\]
Substituting these results back into the expressions for \(n_{B/F}\) and \(p_{B/F}\), we obtain
\[
    \begin{aligned}
        n_{B/F} & = \mathcal{C} \sum_{l=1}^{\infty} (\pm 1)^{l} z^{l+1} \frac{\sqrt{\pi}}{2} \frac{1}{(l+1)^{3/2}} = \frac{g}{\lambda_{T}^3} \sum_{l=1}^{\infty} (\pm 1)^{l} \frac{z^{l+1}}{(l+1)^{3/2}},                         \\
        p_{B/F} & = \frac{2}{3\beta} \mathcal{C} \sum_{l=1}^{\infty} (\pm 1)^{l} z^{l+1} \frac{3\sqrt{\pi}}{8} \frac{1}{(l+1)^{5/2}} = \frac{g}{\beta \lambda_{T}^3} \sum_{l=1}^{\infty} (\pm 1)^{l} \frac{z^{l+1}}{(l+1)^{5/2}}.
    \end{aligned}
\]
These series expansions provide a way to compute the particle density and pressure of the quantum gas in terms of the fugacity \(z\) and temperature \(T\). They are particularly useful for analyzing the behavior of the system in different regimes, such as low or high temperatures, and for comparing the properties of bosonic and fermionic gases. We can make the notation lighter by defining the functions
\[
    \begin{aligned}
        f_{\nu}(z) & = \sum_{l=1}^{\infty} (-1)^{l+1} \frac{z^{l}}{l^{\nu}} \quad \text{(Fermions)}, \\
        g_{\nu}(z) & = \sum_{l=1}^{\infty} \frac{z^{l}}{l^{\nu}} \quad \text{(Bosons)},
    \end{aligned}
\]
so that we can rewrite the expressions for the particle density and pressure as
\[
    \begin{aligned}
        n_{B/F} & = \frac{g}{\lambda_{T}^3} \begin{dcases}
                                                f_{3/2}(z), & \text{(Fermions)}; \\
                                                g_{3/2}(z), & \text{(Bosons)};   \\
                                            \end{dcases}       \\
        p_{B/F} & = \frac{g}{\beta \lambda_{T}^3} \begin{dcases}
                                                      f_{5/2}(z), & \text{(Fermions)}; \\
                                                      g_{5/2}(z), & \text{(Bosons)}.   \\
                                                  \end{dcases}
    \end{aligned}
\]

\subsection{Classical Limit}

\paragraph{Semiclassical expansion.}